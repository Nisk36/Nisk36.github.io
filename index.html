<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="slide.css" rel="stylesheet">
    <title>slide test page</title>
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  </head>
  <body>



    <div class="container">

        <div class="slider">
      
          <div class="slides" id = "slides">
            <!--ここにスライドを作成-->
          </div>
      
        </div>
        <!-- / slider -->
      
        <!-- #Controls -->
        <a class="control fas fa-chevron-left" id="prev"></a>
        <a class="control fas fa-chevron-right" id="next"></a>
      
        <!-- #Position dots -->
        <div class="dots" id="dots">
          <!--ここにスライドの点作成-->
        </div>
      
      </div>
      <!-- / slideshow -->
      

      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getStorage, ref, uploadBytes, getDownloadURL, listAll } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBtJ2EN7_JznLs03fYngKzl0nN6F9-5G9I",
          authDomain: "vuetest-103b3.firebaseapp.com",
          projectId: "vuetest-103b3",
          storageBucket: "vuetest-103b3.appspot.com",
          messagingSenderId: "640887077281",
          appId: "1:640887077281:web:a87322542e2246c1f2f3e0"
        };
        const App = initializeApp(firebaseConfig);
    
        const db = getFirestore();
        const storage = getStorage();
        console.log(storage);
    
        const storageRef = ref(storage);
        
        //HTML動的生成
        const slides = document.getElementById("slides");
        const dots = document.getElementById("dots");

        //連想配列使ってみる
        var data = [];
        var developer = ["RYO","HANIWA"];
        for(var k in developer){
          data[k] = {imgUrl: '',title: '',genre: '',caption: ''};
        }
        console.log(data);
        //ここでは手動で入力する
        data[0]["imgUrl"] = "example_action.png";
        data[0]["title"] = "らんだむちゃんの冒険";
        data[0]["genre"] = "アクションゲーム";
        data[0]["caption"] = "雲の上になんたらかんたら";

        data[1]["imgUrl"] = "example_boardgame.png";
        data[1]["title"] = "ハニワ君の冒険"
        data[1]["genre"] = "タワーディフェンスゲーム"
        data[1]["caption"] = "オーブの力でなんたらかんたら"
        

        function createHTML(k){
          return new Promise((resolve,reject) =>{
            setTimeout(()=>{
              console.log(data[k]["imgUrl"]);
              console.log(data[k]["title"])
              console.log(data[k]["genre"])
              console.log(data[k]["caption"])

              const slides__img = document.createElement("div");
              slides__img.className = "slides__img";
              slides__img.id = " ";
              slides__img.style = "background-image: url('"+data[k]["imgUrl"]+"')"
              slides.appendChild(slides__img);
              console.log("slides_img作成");

              const slides__img__filter = document.createElement("div");
              slides__img__filter.className = "slides__img__filter";
              slides__img.appendChild(slides__img__filter);
              console.log("slides__img__filter作成");

              const slide__caption = document.createElement("div");
              slide__caption.className = "slide__caption";
              slides__img.appendChild(slide__caption);  
              console.log("slides__caption作成");      

              const slide__caption__title = document.createElement("h1");
              slide__caption__title.className = "slide__caption__title";
              slide__caption__title.textContent = data[k]["title"];
              console.log("slide_caption_title作成")
        
              const slide__caption__subtitle = document.createElement("h2");
              slide__caption__subtitle.className = "slide__caption__subtitle";
              slide__caption__subtitle.textContent = data[k]["genre"];
              console.log("slide_caption_subtitle作成")

              const slide__caption__text = document.createElement("h3");
              slide__caption__text.className = "slide__caption__text";
              slide__caption__text.textContent = data[k]["caption"];
              console.log("slide_caption_text作成")
        
              slide__caption.appendChild(slide__caption__title);
              slide__caption.appendChild(slide__caption__subtitle);
              slide__caption.appendChild(slide__caption__text);
              console.log("HTMLセット作成完了")
              resolve();

              const dots__single = document.createElement("span");
              dots__single.className = "dots__single";
              dots__single.id = ' ';
              dots.appendChild(dots__single);
              console.log("スライドの下の点生成")
            },100)
          })
          
        }



        async function createHTMLSync(){
          for(var v in data){
            console.log(v);
            await createHTML(v);
            console.log("HTML作成完了")
            console.log(slides);
          }
        }

        createHTMLSync();


        console.log(slides);
        
    </script>
    <script src="slide.js"></script>
  </body>
</html>